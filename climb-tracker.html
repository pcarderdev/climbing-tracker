<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Climb Tracker</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>CLIMB TRACKER</h1>
        <div class="subtitle">Track progress. Send harder.</div>
      </header>

      <!-- Landing view -->
      <div id="landingView">
        <div class="card">
          <button class="btn-primary" onclick="showSessionSetup()">
            Start Session
          </button>
        </div>

        <div class="stats hidden" id="statsView">
          <div
            class="stat-card"
            onclick="showAnalytics()"
            style="cursor: pointer"
          >
            <div class="stat-value" id="totalClimbs">0</div>
            <div class="stat-label">Total Climbs</div>
          </div>
          <div
            class="stat-card"
            onclick="showSessionHistory()"
            style="cursor: pointer"
          >
            <div class="stat-value" id="totalSessions">0</div>
            <div class="stat-label">Sessions</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="sendRate">0%</div>
            <div class="stat-label">Send Rate</div>
          </div>
        </div>
      </div>

      <!-- Active session view -->
      <div id="sessionView" class="hidden">
        <div class="session-info">
          <div class="session-header">
            <div>
              <div class="session-type" id="sessionType"></div>
              <div class="session-gym" id="sessionGym"></div>
              <div class="session-gym" id="sessionDuration">0:00</div>
            </div>
            <button class="btn-secondary btn-small" onclick="endSession()">
              End Session
            </button>
          </div>
        </div>

        <div class="card">
          <button class="btn-primary" onclick="showLogClimb()">
            + Log Climb
          </button>
        </div>

        <div class="stats">
          <div class="stat-card">
            <div class="stat-value" id="sessionClimbs">0</div>
            <div class="stat-label">Climbs</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="sessionSends">0</div>
            <div class="stat-label">Sends</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="sessionHighGrade">-</div>
            <div class="stat-label">High Point</div>
          </div>
        </div>

        <div class="climb-list" id="climbList">
          <div class="empty-state">
            <div class="empty-state-icon">ðŸ§—</div>
            <p>Log your first climb to get started</p>
          </div>
        </div>
      </div>

      <!-- Session History view -->
      <div id="historyView" class="hidden">
        <div class="card">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 20px;
            "
          >
            <h2 style="font-size: 22px; font-weight: 700">Session History</h2>
            <button class="btn-secondary btn-small" onclick="closeHistory()">
              Back
            </button>
          </div>
          <div id="sessionHistoryList" class="climb-list">
            <!-- Will be populated with sessions -->
          </div>
        </div>
      </div>
    </div>

    <!-- Session Detail view -->
    <div id="sessionDetailView" class="hidden">
      <div class="card">
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
          "
        >
          <div>
            <h2
              style="font-size: 22px; font-weight: 700"
              id="detailSessionTitle"
            ></h2>
            <div
              style="
                font-size: 14px;
                color: var(--text-secondary);
                margin-top: 4px;
              "
              id="detailSessionInfo"
            ></div>
          </div>
          <button
            class="btn-secondary btn-small"
            onclick="closeSessionDetail()"
          >
            Back
          </button>
        </div>
        <div id="sessionDetailClimbList" class="climb-list">
          <!-- Will be populated with climbs -->
        </div>
      </div>
    </div>

    <!-- Analytics view -->
    <div id="analyticsView" class="hidden">
      <div class="card">
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
          "
        >
          <h2 style="font-size: 22px; font-weight: 700">Climb Analytics</h2>
          <button class="btn-secondary btn-small" onclick="closeAnalytics()">
            Back
          </button>
        </div>

        <!-- Type selector -->
        <div class="form-group">
          <label>Type</label>
          <div class="button-group">
            <button
              class="toggle-btn active"
              id="analyticsTypeBoulder"
              onclick="selectAnalyticsType('boulder')"
            >
              Boulder
            </button>
            <button
              class="toggle-btn"
              id="analyticsTypeRope"
              onclick="selectAnalyticsType('rope')"
            >
              Rope
            </button>
          </div>
        </div>

        <!-- Session range selector -->
        <div class="form-group">
          <label>Latest Sessions</label>
          <div class="button-group three">
            <button
              class="toggle-btn active"
              id="analyticsRange3"
              onclick="selectAnalyticsRange(3)"
            >
              3
            </button>
            <button
              class="toggle-btn"
              id="analyticsRange5"
              onclick="selectAnalyticsRange(5)"
            >
              5
            </button>
            <button
              class="toggle-btn"
              id="analyticsRange10"
              onclick="selectAnalyticsRange(10)"
            >
              10
            </button>
          </div>
        </div>

        <!-- Chart container -->
        <div id="analyticsChart"></div>
      </div>
    </div>

    <!-- Session Setup Modal -->
    <div id="sessionSetupModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">Start Session</h2>
          <button class="close-btn" onclick="closeModal('sessionSetupModal')">
            &times;
          </button>
        </div>

        <div class="form-group">
          <label>Gym</label>
          <select id="gymSelect">
            <option value="Durham">TRC - Durham</option>
            <option value="Salvage">TRC - Salvage Yard</option>
            <option value="Morrisville">TRC - Morrisville</option>
            <option value="Other">Other</option>
          </select>
        </div>

        <div class="form-group">
          <label>Session Type</label>
          <div class="button-group">
            <button
              class="toggle-btn active"
              onclick="selectSessionType('boulder')"
            >
              Boulder
            </button>
            <button class="toggle-btn" onclick="selectSessionType('rope')">
              Rope
            </button>
          </div>
        </div>

        <div class="modal-actions">
          <button
            class="btn-secondary"
            onclick="closeModal('sessionSetupModal')"
          >
            Cancel
          </button>
          <button class="btn-primary" onclick="startSession()">Start</button>
        </div>
      </div>
    </div>

    <!-- Log Climb Modal -->
    <div id="logClimbModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">Log Climb</h2>
          <button class="close-btn" onclick="closeModal('logClimbModal')">
            &times;
          </button>
        </div>

        <div class="form-group">
          <label>Grade</label>
          <select id="gradeSelect">
            <!-- Will be populated based on session type -->
          </select>
        </div>

        <div class="form-group">
          <label>Outcome</label>
          <div class="button-group four" id="outcomeButtons">
            <!-- Will be populated dynamically -->
          </div>
        </div>

        <div class="form-group" id="styleGroup">
          <label>Style</label>
          <div class="button-group" id="styleButtons">
            <!-- Will be populated based on session type -->
          </div>
        </div>

        <div class="form-group">
          <label>Difficulty</label>
          <div class="button-group three">
            <button class="toggle-btn" onclick="setDifficulty('soft')">
              Soft
            </button>
            <button class="toggle-btn active" onclick="setDifficulty('on')">
              On
            </button>
            <button class="toggle-btn" onclick="setDifficulty('hard')">
              Hard
            </button>
          </div>
        </div>

        <div class="form-group">
          <label>Tags (Optional)</label>
          <div class="tag-group" id="tagGroup">
            <button class="tag-btn" onclick="toggleTag(this)">Crimpy</button>
            <button class="tag-btn" onclick="toggleTag(this)">Powerful</button>
            <button class="tag-btn" onclick="toggleTag(this)">Technical</button>
            <button class="tag-btn" onclick="toggleTag(this)">Slopey</button>
            <button class="tag-btn" onclick="toggleTag(this)">Overhang</button>
            <button class="tag-btn" onclick="toggleTag(this)">Slab</button>
            <button class="tag-btn" onclick="toggleTag(this)">Endurance</button>
            <button class="tag-btn" onclick="toggleTag(this)">Dynamic</button>
          </div>
        </div>

        <div class="form-group">
          <label>Notes (Optional)</label>
          <textarea
            id="climbNotes"
            placeholder="Any thoughts on the climb..."
          ></textarea>
        </div>

        <div class="modal-actions">
          <button class="btn-secondary" onclick="closeModal('logClimbModal')">
            Cancel
          </button>
          <button class="btn-primary" onclick="saveClimb()">Save Climb</button>
        </div>
      </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <!-- Firebase Config -->
    <script src="firebase-config.js"></script>

    <!-- App -->
    <script src="climb-tracker.js"></script>
  </body>
</html>
